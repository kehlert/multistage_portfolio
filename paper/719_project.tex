\documentclass{amsart}

\usepackage{amssymb, amsfonts, hyperref, graphicx}
\usepackage{enumerate}

\newtheorem{thm}{Theorem}[section]
\newtheorem{cor}[thm]{Corollary}
\newtheorem{prop}[thm]{Proposition}
\newtheorem{lem}[thm]{Lemma}

\theoremstyle{definition}
\newtheorem{defn}[thm]{Definition}
\newtheorem{defns}[thm]{Definitions}
\newtheorem{con}[thm]{Construction}
\newtheorem{exmp}[thm]{Example}
\newtheorem{exmps}[thm]{Examples}
\newtheorem{notn}[thm]{Notation}
\newtheorem{notns}[thm]{Notations}
\newtheorem{addm}[thm]{Addendum}
\newtheorem{exer}[thm]{Exercise}

\theoremstyle{remark}
\newtheorem{rem}[thm]{Remark}
\newtheorem{rems}[thm]{Remarks}
\newtheorem{warn}[thm]{Warning}
\newtheorem{sch}[thm]{Scholium}

\bibliographystyle{plain}

\graphicspath{ {../figures/} }

%--------Meta Data: Fill in your info------
\title{Optimizing Multistage Portfolio Returns with Risk Constraints}

\author{Kurt Ehlert}

\date{\today}

\begin{document}

\begin{abstract}

TODO here goes the abstract

\end{abstract}

\maketitle

\tableofcontents

\section{Modeling Stocks with Geometric Brownian Motion}
Stochastic differential equations (SDEs) are commonly used to model stock prices over time. In particular,
geometric Brownian motion (GBM) is often used.\cite{hull} In this paper, we will use GBM with constant coefficients to model stock prices over time. The SDE for GBM is
\begin{equation}\label{eq:GBM_SDE}
dX_t = \mu X_t dt + \sigma X_t dB_t
\end{equation}
where $\mu$ and $\sigma$ are respectively the drift and volatility parameters, and $B_t$ is Brownian motion at time $t$. We call $X_t$ GBM, and see figure \ref{fig:mesh1} for some example GBM paths.

\begin{figure}
\centering
\includegraphics[scale=0.5]{geometric_bm.png}
\caption{Paths of geometric Brownian motion generated by the Euler-Maruyama method. Code can be found at TODO. $X_0 = 50, \mu=0.1, \sigma=0.2$.}
\label{fig:mesh1}
\end{figure}

\subsection{1-D Geometric Brownian Motion}
We can solve \eqref{eq:GBM_SDE} by using an integrating factor $Z_t$ \cite[p. 235]{timo}:
\begin{equation*}
Z_t = \exp\left(-\mu t -\sigma B_t + \sigma^2 t/2 \right)
\end{equation*}
For most of the following calculations, we will drop the subscript $t$. By It\^o's lemma we know that
\begin{equation}\label{eq:GBM_SDE_PROD}
d(XZ) = X dZ + Z dX + d[X,Z]
\end{equation}
where $[\cdot,\cdot]$ denotes quadratic covariation. The goal is to substitute in expressions for each of the variables on the right-hand side of the above expression. It\^o's lemma gives us $dZ$
\begin{equation*}
dZ = Z \left[\left(-u + \sigma^2\right) dt - \sigma dB\right]
\end{equation*}
Now we need to calculate the quadratic covariation of $X$ and $Z$,
\begin{align*}
\begin{split}
d[X,Z]_t &= d\left[\int_0^t \mu X_s ds + \int_0^t \sigma X_s dB_s,  \int_0^t (-\mu +\sigma^2) Z_s ds - \int_0^t \sigma Z_s dB_s \right]_t\\
&= d\left[\int_0^t \sigma X_s dB_s,  - \int_0^t \sigma Z_s dB_s \right]_t\\
&= -\sigma ^2 \frac{d}{dt}\int_0^t X_s Z_s ds\\
&= -\sigma^2 X_t Z_t dt
\end{split}
\end{align*}
Thus \eqref{eq:GBM_SDE_PROD} becomes
\begin{align*}
d(XZ) &= Z(\mu X dt + \sigma X dB) + XZ\left[\left(-\mu + \sigma^2 \right)dt -\sigma dB \right] - \sigma^2 X Z dt
&= 0
\end{align*}
Therefore $X_t Z_t = X_0 Z_0 = X_0$, which implies that
\begin{equation}\label{eq:GBM_soln}
X_t =  X_0 Z_t^{-1} = X_0 \exp\left[(\mu - \sigma^2/2) t + \sigma B_t\right]
\end{equation}
Then use It\^o's lemma to check that \eqref{eq:GBM_soln} solves \eqref{eq:GBM_SDE}. It is clear that $\log(X)$ is normally distributed, and
\begin{align*}
\mathbb{E}[\log X ] &= (\mu - \sigma^2/2)t\\
\text{Var}(\log X ) &= \sigma^2 t
\end{align*} 
Thus $X_t$ has a log-normal distribution, and
\begin{align*}
\mathbb{E} X&= X_0 e^\mu\\
\text{Var}X &= X_0^2 e^{2\mu t}(e^{\sigma^2 t} - 1)
\end{align*}

\subsection{Correlated d-Dimensional Geometric Brownian Motion}
If the Brownian motions driving each SDE are all independent, then the solution is just the d-dimensional version of \eqref{eq:GBM_soln}. The much more interesting case is when there is a positive correlation between the different dimensions. In other words, we want to find and solve the SDE where $X(t)$ is d-dimensional GBM and $\text{Corr}(X_i(t), X_j(t)) = \rho_{ij}$. This would allow us to model correlated stock prices.

\section{Optimizing a Portfolio}
Assume that there are $n$ stocks we can invest in, and also one risk-free asset that gives a constant rate of return $r$. We will model the path of all the stock prices as $n$ independent geometric Brownian motions. The average rate of return (also known as drift) and the volatility of each stock can vary.

If we simply want to maximize the expected return, then we should put all of our money into the asset with the highest expected return. However, that is not a very sensible approach, because it does not take into account our risk tolerance. The goal of this section is to present two approaches for balancing the expected return and the risk. The first approach is the one used by Markowitz, where we will maximize the return subject to a constraint on the variance of the return. The second method is to maximize the return subject to a constraint on the conditional value-at-risk (CV@R).

\subsection{Markowitz's approach}
\subsubsection{Portfolio Optimization Problem Description}
Suppose that we have $W$ dollars to invest, and we want to maximize the expected return after time $T$. However, we also want to keep the variance of the return below a specified level. There are $n$ stocks to invest in. Let $X_i(t)$ be the price of stock $i$ at time $t$. As mentioned earlier, we model the stock prices as independent paths of geometric Brownian motion. Therefore $X_i(t)$ is log-normally distributed, and
\begin{align*}
\mathbb{E} X_i(t) &= X_i(0)e^{\mu_i t}\\
\text{Var} X_i(t) &= X_i(0)^2e^{2\mu_i t}\left(e^{\sigma_i^2 t} -1\right)
\end{align*}
Let $R_i$ be the random return of stock $i$.
\begin{equation*}
R_i = \frac{X_i(t)}{X_i(0)} \implies \log R_i = (\mu_i - \sigma_i^2 / 2) t + \sigma dB_t
\end{equation*}
Therefore the return $R_i$ is also log-normally distributed, with
\begin{align*}
\mathbb{E}R_i &= e^{\mu_i t}\\
\text{Var}R_i &= e^{2\mu_i t}\left(e^{\sigma_i^2 t} -1\right)
\end{align*}

There is also a risk-free asset with a constant rate of return $r$. Let $x_i$ be the amount of capital allocated to stock $i$, and $x_r$ be the amount of capital invested in the risk-free asset. Let $C(x, R_i)$ be the amount of capital we have at time $t$. Then
\begin{equation*}
C(x, R_i) = r x_r + \sum_{i=1}^n R_i x_i 
\end{equation*}
Let $\Sigma$ be the $n\times n$ covariance matrix of the stocks. Then
\begin{align*}
\text{Var}[ C(x,R_i)] = x^T \Sigma x
\end{align*}
Thus the problem we want to solve is
\begin{equation}
\max_{x\ge 0} \mathbb{E}C(x, R_i) = r x_r + \sum_{i=1}^n x_i e^{\mu_i t}, x^T \Sigma x \le v
\end{equation}
We can actually solve the above problem with Lagrange multipliers.

\subsubsection{Solving the Markowitz Portfolio Optimization Problem}
\begin{thm}
This is the statement of a theorem.
\end{thm}
\begin{proof}
And this shows that the statement is correct.
\end{proof}

Note that the numbering is taken care of automatically, and that we've predefined a bunch of these sorts of environments to take care lemmas, corollaries and such in the header. 

Another useful kind of environment is the equation environment.  Equations
get numbered in sequence with statements, as for example

\begin{equation}  e = mc^2
\end{equation}

Note if you do not want a numbered equation, you can use the
environment ``equation*''
 like so:

\begin{equation*}
e=mc^2
\end{equation*}

There are plenty of other equation-type enviroments that allow you to
align several equations and such. The AMS's guide is a
good place to start with these.

You can also typeset math directly in a paragraph by placing it within
dollar signs.  This is called ``math mode.''  For example: Let $e$
be energy, $m$ be momentum and $c$ be the speed of light.  Then
Einstein's famous equation says that $e=mc^2$.  This is useful, but
remember that it is harder to read inline math than displayed math. 

Remember that letters get put in a different font in math mode, so
whenever you are referencing a mathematical object you should always
put it in dollar signs.  For example, $f$ is a function, but f is just
a random letter.

Both and  have good lists of other symbols you can use in math mode.
These include greek letters ($\alpha, \beta, \Gamma, \Delta$),
operators ($\otimes, +, \sum$) and much more ($\leq, \diamond$).


\section{V@R, CV@R}

If you want to draw diagrams, you should use xypic.  It's actually
much easier than it looks, and we've already included it in the header
above.  Here is an example. 

\section{multistage}

\subsection*{Acknowledgments}  I downloaded and then modified the \LaTeX template at \url{www.math.uchicago.edu/~may/VIGRE/VIGRE2011/TEMPLATE.tex}

\bibliography{719_project}
\bibliographystyle{ieeetr}

\end{document}

